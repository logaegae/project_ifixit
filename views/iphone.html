{% extends "./blocks/layout.html" %}
{% block content %}

<style>
   .table thead{
      border:2px #999 solid;
   }
   .table thead th{
      border-bottom:2px #999 solid !important;
   }

   .ipad_text{
      display: inline-block;
   }
   @media screen and (max-width: 767px)
   {
      .ipad_img {
           display: none
       }
      .ipad_text{
         display: block
      }
   }
</style>

   <!-- PAGE TITLE -->
   <header class="pagetitle pagetitle-sm">
      <div class="container">
         <div class="divtable irow">
            <div class="divcell">
               <i class="fa fa-columns"></i>
               <h1>아이폰 수리비용</h1>
               <div class="divider"></div>
               <span class="subtitle">아이폰 고장 증상 및 부품 별 수리비 안내</span>
            </div>
            <div class="divcell text-right">
               <ol class="breadcrumb">
                  <li><a href="#">홈</a></li>
                  <li class="active">아이폰 수리비용</li>
               </ol>
            </div>
         </div>
      </div>
   </header>
   <!-- /.pagetitle -->
   <hr class="hr-nobg">
   <div class="container">
      <section class="row page-header text-center">
         <div class="col-md-8 col-md-offset-2 col-sm-10 col-sm-offset-1">
            <div class="icon icon-color icon-size-7">
               <i class="fa fa-hdd-o"></i>
            </div>
            <h1>아이폰 기종별 수리비용</h1>
            <!-- <p>사용중 부주의 또는 소프트웨어의 오류 등으로 인하여 단말기가 정상동작을 못하거나 구동이 안될때,
               <br>단말기의 핵심인 PCB 어셈블리를 칩셋단위로 수리하는 것을 말합니다.</p> -->
         </div>
      </section>
   </div>
   <hr class="hr-nobg hr-md">
   <!-- CONTENT -->
   <div class="content no-all-paddings">
      <div class="container">
         <div class="row irow-sm text-center cards cards-inside repaire_card">
            {% for model in models %}
               {% if model.phoneGroup == 1 %}
               {% set phoneName = model.modelName | replace('_',' ','g') | replace('plus','+','g') %}
                  <div class="col-md-3 col-sm-4 col-sm-6 box" id="box{{model.phoneId}}">
                     <a href="" class="card-flip" data-toggle="modal" data-target="#large-modal">
                        <div class="flipper">
                           <div class="front card card-dark">
                              <figure class="figure" id="figureF{{model.phoneId}}">
                                 <!-- <a href=""> -->
                                 <script>
                                    var img = new Image();
                                    img.onload=function(){document.getElementById('figureF{{model.phoneId}}').innerHTML = '<img src="{{model.photo}}" alt="">'}
                                    img.onerror=function(){document.getElementById('figureF{{model.phoneId}}').innerHTML = '<img src="{{model.photo}}" alt="">'}
                                    img.src='{{model.photo}}';
                                 </script>
                                    <!-- <img src="{{model.photo}}" alt=""> -->
                                 <!-- </a> -->
                              </figure>
                              <div class="icon icon-color icon-size-5">
                                 <i class="fa  fa-mobile"></i>
                              </div>
                              <h4 class="box_name1">{{phoneName}}</h4>
                              <!-- <p>iPhone 6s+ 부품별 수리비 안내</p> -->
                              <div class="heading-divider"></div>
                           </div>
                           <div class="back card card-light">
                              <figure class="figure" id="figureB{{model.phoneId}}">
                                 <!-- <a href=""> -->
                                 <script>
                                    var img = new Image();
                                    img.onload=function(){document.getElementById('figureB{{model.phoneId}}').innerHTML = '<img src="{{model.photo}}" alt="">'}
                                    img.onerror=function(){document.getElementById('figureB{{model.phoneId}}').innerHTML = '<img src="{{model.photo}}" alt="">'}
                                    img.src='{{model.photo}}';
                                 </script>
                                    <!-- <img src="{{model.photo}}" alt=""> -->
                                 <!-- </a> -->
                              </figure>
                              <div class="icon icon-color icon-size-4">
                                 <i class="fa fa-apple"></i>
                              </div>
                              <h4 class="box_name2">{{phoneName}}</h4>
                              <!-- <p>iPhone 6s+ 부품별 수리비 안내</p> -->
                              <div class="heading-divider"></div>
                           </div>
                        </div>
                     </a>
                  </div>
               {% endif %}
            {% endfor %}
            <div class="col-md-12 col-ms-12 col-xs-12">
               <!-- <a href=""> -->
                  <div class="flipper">
                     <div class="card card-dark" style="background-color:#2b2b2b;">
                        <div class="col-md-5 col-ms-5 col-xs-5 ipad_img text-right">
                           <img src="../../images/ipad1.png" alt="" style="width:150px;">
                        </div>

                        <div class="ipad_text">
                           <div class="icon icon-color icon-size-4">
                              <i class="fa fa-tablet"></i>
                           </div>
                           <h4 style="color:#fff">iPad</h4>
                           <p><strong>아이패드 수리비용은 지점마다 상이할 수 있습니다.</strong></p>
                           <button class="btn btn-primary" type="button" name="button" onclick="location.href='contact_write.html'">수리문의</button>
                           <div class="heading-divider"></div>
                        </div>

                     </div>
                     <!-- <div class="back card card-light ipad">
                        <div class="icon icon-color icon-size-4">
                           <i class="fa fa-tablet"></i>
                        </div>
                        <h4>아이패드</h4>
                        <p><strong>자세한 사항은 지점에 문의해주시기 바랍니다.</strong>
                           <br>※ 클릭시 지점으로 이동합니다.</p>

                        <div class="heading-divider"></div>
                     </div> -->
                  </div>
               <!-- </a> -->
            </div>
         </div>
      </div>
   </div>
   <hr class="hr-nobg hr-md">
   <!-- /.content -->


   <!-- Modal Large -->
    <div class="modal fade" id="large-modal">
       <div class="modal-dialog modal-lg">
          <div class="modal-content">
             <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times"></i></button>
                <h6 class="modal-title">아이폰 수리가격</h6>
             </div>
             <div class="modal-body text-center">
                <div class="modal-body-inside">
                   <div class="icon icon-color icon-size-4" >
                      <i class="fa fa-heart-o"></i>
                   </div>
                   <h4>아이폰 수리 가격표</h4>
                   <div class="heading-divider"></div>
                        <div class="table-responsive">
                            <h5 class="text-left">수리서비스</h5>
                        <table class="table table-bordered text-left repaire_table">
                           <thead>
                              <tr>
                                 <th colspan="4" style="vertical-align:middle; text-align:center">부품명</th>
                                 <th style="vertical-align:middle; text-align:center">부품가격</th>
                                 <th style="vertical-align:middle; text-align:center">공임비</th>
                              <th style="vertical-align:middle; text-align:center">합계</th>
                              </tr>
                           </thead>
                           <tbody class="modal_body">
                           </tbody>
                        </table>
                            <ul class="text-left">

                                <li><i class="fa fa-caret-right"></i> 각 지점별로 할인 행사가 진행중으로 약간에 가격차이가 있을 수 있습니다.</li>
                                <li><i class="fa fa-caret-right"></i>LCD터치패널 교체시 파손된 LCD는 반납조건입니다.</li>
                                <li><i class="fa fa-caret-right"></i>LCD터치패널 교체시 터치안됨/멍/LCD파손 시 추가금액이 발생합니다.</li>
                            </ul>

                     </div>
                   <a href="" class="btn btn-primary btn-wide" data-dismiss="modal">닫기</a>
                </div>
             </div>
          </div>
       </div>
    </div>
<script type="text/javascript">
   window.onload = function(){
      function priceWidthComma(target){
         var len = target.toString().length;
         var rtnStr = "";
         if(target != 0 && typeof(target) == 'number'){
            for(var i=0, j=len; i<len ; i++, j--){
               if(j % 3 == 0 && j != len){
                  rtnStr+=",";
               };
               rtnStr+=target.toString().charAt(i);
            };
         return rtnStr+'원';
         }else{
            return '-';
         }
      }

      var data = {{JSON.stringify(prices,0,4)}};
      $('.box').click(function(){
         $('#large-modal tbody > tr').remove();
         var addr = Number($(this).attr('id').substring(3));
         var name = $(this).find('.front').find('h4').text();
         var arryNum = 0;
         var lineCount = [];
         var imsiNew = null;
         var imsiOld = null;
         var nullCount = 0;

         $('#large-modal h6').text(name+' 수리가격');
         $('#large-modal h4').text(name+' 수리 가격표');
         $(data).each(function(i,e){
            if(e.phoneId == addr){
               var item = '<tr>'
               item += '<td colspan="4" style="vertical-align:middle; text-align:center">'+e.partName+'</td>';
               item += '<td>'+priceWidthComma(e.partPrice)+'</td>';
               item += '<td>'+priceWidthComma(e.pay)+'</td>';
               item += '<td><strong>'+priceWidthComma(e.partPrice + e.pay)+'</strong></td>';
               item += '</tr>';
               $('.modal_body').append(item);

               imsiNew = e.typeName;

               //초기값
               if(!imsiOld){
                  imsiOld = imsiNew;
                  if(!imsiOld && nullCount == 1){
                     lineCount[arryNum]++;
                  }else if(nullCount == 0){
                     nullCount++;
                     lineCount[arryNum] = 1;
                  }
               }
               //종목이 같을 때
               else if(imsiNew == imsiOld){
                  lineCount[arryNum]++;
               }
               //종목이 다를 때
               else if(imsiNew != imsiOld){
                  arryNum++;
                  lineCount[arryNum] = 1;
                  imsiOld = imsiNew;
                  nullCount = 0;

               }
            }
         });
         $('.modal_body').append('<tr><td colspan="4" style="vertical-align:middle; text-align:center">기타 문의</td><td colspan="3">상담 후 안내 드립니다.<br/><a href="contact_write.html" class="btn btn-warning btn-wide" style="margin:10px;">문의하기</a></td></tr>');

         arryNum = 0;
         imsiNew = lineCount[0];
         $('table tbody tr').each(function(i,e){
            //처음
            if(lineCount[arryNum] == imsiNew && imsiNew != 1){
               $(e).css({
                  'border-top':'2px #999 solid',
                  'border-left':'2px #999 solid',
                  'border-right':'2px #999 solid'
               });
               lineCount[arryNum]--;
            }
            //중간
            else if(lineCount[arryNum] > 1){
               $(e).css({
                  'border-left':'2px #999 solid',
                  'border-right':'2px #999 solid'
               });
               lineCount[arryNum]--;
            }
            //마지막
            else if(lineCount[arryNum] <= 1 && imsiNew != 1){
               $(e).css({
                  'border-bottom':'2px #999 solid',
                  'border-left':'2px #999 solid',
                  'border-right':'2px #999 solid'
               });
               arryNum++;
               imsiNew = lineCount[arryNum];
            }
            //1개만 있을 경우
            else if(imsiNew == 1){
               $(e).css({
                  'border':'2px #999 solid'
               });
               arryNum++;
               imsiNew = lineCount[arryNum];
            }
            //마지막 줄
            if(i == $('table tbody tr').length - 1){
               $(e).css({
                  'border':'2px #999 solid'
               });

            }
         })
      });

   }
</script>
    <!-- /.modal -->
{% endblock %}
